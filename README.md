# commit-msg hookでコミットメッセージをlintするlinter

を作りたいなと思ったので作ってみる。  
見切り発車のふわふわ仕様。  

名前は後で変える。

## 雰囲気

* .git/hooks/commit-msgから `cml $1` のように呼ばれることを想定する。  
* linterとしての設定は特定のパスに配置した設定ファイルを使用する。
* 設定ファイルのパスは環境変数から変更できる。引数でも変更できる。
* 引数`--install` とかで.git/hooks/commit-msgに呼び出しコマンドを書き込む。
* 処理
	1. 第一引数で与えられた文字列をコミットメッセージがかかれたテキストファイルのパスだと見做して読み込む。
	1. コミットメッセージの書式をチェックし、チェック結果を標準出力に出力する。
	1. 書式に問題がなければ正常終了、問題があれば異常終了する。

## コミットメッセージの書式

よくあるあれ

```
型(影響範囲 なくてもよい): タイトル      : コミットの内容を1行に簡潔にまとめたサマリー
                                         : 1行空行を入れる bodyが入れないなら不要
body                                     : 変更点についての詳細な説明 無くてもよい
                                         : 1行空行を入れる footerが入れないなら不要
footer                                   : 破壊的変更がある場合に特に使われる
```

## 型について

types: feat, fix, docs, style, refactor, test, chore(maintain)

* feat:     新しい機能
* fix:      バグの修正
* docs:     ドキュメントのみの変更
* style:    空白、フォーマット、セミコロン追加など
* refactor: 仕様に影響がないコード改善(リファクタ)
* perf:     パフォーマンス向上関連
* test:     テスト関連
* chore:    ビルド、補助ツール、ライブラリ関連

## 影響範囲について

これは省略可能。

## タイトルについて

* 英語の場合現在形、すべて小文字、末尾にピリオドを打たない、というルールがある。
* 日本語ならば現在形で句点「。」を書かないというルールになると思われる。
* 型によってはissue番号を#???とかで先頭につけることを必須にする？

## footerについて

破壊的な変更に関するあらゆる情報をフッターに含めることが多いので
`BREAKING CHANGE: ` があった場合にチェックする。
破壊的な変更による影響範囲と変更による影響がどの程度なのか書いてある事を要求したい。

* コミットメッセージの先頭行の`:`の前に`!`をつける。
* 以下の書式で書かれていてほしい。
* どれくらいチェックするかは微妙。

```
BREAKING CHANGE: <破壊的変更についての説明>
<破壊的変更についての説明 複数行書いてもよい>

<破壊的変更に対処する方法>

Before:

<変更前がどうであったか>

After:

<変更後がどうなったか>

<影響がどれくらいの被害なのか>
```
